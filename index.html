<html>
    <head>
        <title>index</title>
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    </head>
    <body>
        this is a page with nothing content
        <script src="rss-parser.min.js"></script>
        <script src="md5.js"></script>
        <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
    </body>
    <script>
        var dataFlag = 'of';
        const CORS_PROXY = "https://cors-anywhere.herokuapp.com/"
        setInterval(()=>{
            $.get(CORS_PROXY+'https://www.ithome.com/rss',(data,status)=>{
                console.log(data.title);
                var dataHash = hex_md5(data);
                console.log(dataHash);
                if(dataFlag != dataHash){
                    let parser = new RSSParser();
                    parser.parseURL(CORS_PROXY + 'https://www.ithome.com/rss/', function(err, feed) {
                        Notification.requestPermission();                        
                        console.log(feed.items[0].title);
                        var notification = new Notification('ithome',{
                            dir: 'auto',
                            icon: 'https://www.ithome.com/favicon.ico',
                            data: {
                                url: feed.items[0].link
                            },
                            body: feed.items[0].title
                        })
                        notification.onclick = function(){
                            window.open(notification.data.url);
                            notification.close();
                        }
                    })
                    dataFlag = dataHash;
                    console.log(dataFlag);
                }
                else{
                    console.log(1);
                }
            })
        },5000)
    </script>
</html>